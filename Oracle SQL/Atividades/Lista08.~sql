CREATE TABLE estados (
	codigo NUMBER GENERATED by default on null as IDENTITY,
    nome   VARCHAR2(50),
    
    CONSTRAINT pk_codigo_estado PRIMARY KEY(codigo)
);

CREATE TABLE cidades (
	codigo NUMBER GENERATED by default on null as IDENTITY,
    nome   VARCHAR2(50),
    estado NUMBER,
    
    CONSTRAINT pk_codigo_cidade PRIMARY KEY (codigo),
    CONSTRAINT fk_codigo_estado FOREIGN KEY (estado) REFERENCES estados (codigo)
);

CREATE TABLE centro_distribuicao (
	codigo NUMBER GENERATED by default on null as IDENTITY,
    nome   VARCHAR2(50),
    cidade NUMBER,
	bairro VARCHAR2(40),
	logradouro VARCHAR2(50),
    
    CONSTRAINT pk_codigo_centro_distribuicao PRIMARY KEY (codigo),
    CONSTRAINT fk_codigo_cidade FOREIGN KEY (cidade) REFERENCES cidades (codigo)
);


INSERT INTO estados (nome) VALUES ('Rio Grande do Sul');
INSERT INTO estados (nome) VALUES ('Santa Catarina');
INSERT INTO estados (nome) VALUES ('Paraná');
INSERT INTO estados (nome) VALUES ('São Paulo');
INSERT INTO estados (nome) VALUES ('Rio de Janeiro');
INSERT INTO estados (nome) VALUES ('Minas Gerais');
INSERT INTO estados (nome) VALUES ('Goiás');
SELECT * FROM estados;

INSERT INTO cidades (nome, estado) VALUES ('Porto Alegre', 1);
INSERT INTO cidades (nome, estado) VALUES ('Joinville', 2);
INSERT INTO cidades (nome, estado) VALUES ('Viamão', 1);
INSERT INTO cidades (nome, estado) VALUES ('Londrina', 3);
INSERT INTO cidades (nome, estado) VALUES ('Campinas', 4);
INSERT INTO cidades (nome, estado) VALUES ('Blumenau', 2);
INSERT INTO cidades (nome, estado) VALUES ('Anápolis', 7);
INSERT INTO cidades (nome, estado) VALUES ('Belo Horizonte', 6);
INSERT INTO cidades (nome, estado) VALUES ('São Paulo', 4);
INSERT INTO cidades (nome, estado) VALUES ('Curitiba', 3);
INSERT INTO cidades (nome, estado) VALUES ('Niterói', 5);
INSERT INTO cidades (nome, estado) VALUES ('Uberaba', 6);
SELECT * FROM cidades;

INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Galpão Industrial Mueller', 4, 'Tiradentes', 'Rodovia Osvaldo Cruz');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Complexo Missner', 1, 'Lourdes', 'Avenida Antonio Alz');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Centro de despacho - MXT', 7, 'Cristóvão', 'Rodovia Assis Dutra');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Galg - Distribuidora', 2, 'Ulisses Costa', 'Rodovia Margem Grande');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Log - Avir', 6, 'Itoupavazinha', 'Rua Paris');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Lerroy', 5, 'Canindé', 'Avenida Presidente Dutra');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Expresso Cargas', 4, 'Comandatuba', 'Avenida Braga Neto');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Apx - Cargas', 12, 'Liberdade', 'Rua Divinópolis');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Wundz - Distribuidora', 6, 'Garcia', 'Rua Amazonas');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('ABC Logística', 5, 'Raposo Tavares', 'Avenida Raposo Tavares');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Linx Cargas', 10, 'Lontras', 'Rodovia Bento Mafra');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('JG - Depósito', 3, 'Monte Verde', 'Rua Amber Rudolph');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('HXG - Distribuidora', 9, 'Diadema', 'Avenida Tibiriçá');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Backks - Lojística', 8, 'Tamandaré', 'Rua Tijucas');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Livina', 11, 'Presidente Vaz', 'Avenida Monte Cristo');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('RGT - Cargas', 7, 'Adelina Silva', 'Rua Saquarema');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('XHG - Express', 9, 'Martinez', 'Avenida Sapopemba');
INSERT INTO centro_distribuicao (nome, cidade, bairro, logradouro) VALUES ('Luciaz', 2, 'Luiz Abbraz', 'Rua Dionízio Arms');
SELECT * FROM centro_distribuicao;


SELECT
	centro_distribuicao.nome AS Nome,
    cidades.nome AS Cidade,
    estados.nome AS Estados
FROM centro_distribuicao
INNER JOIN cidades ON (cidades.codigo = centro_distribuicao.cidade)
INNER JOIN estados ON (estados.codigo = cidades.estado);


SELECT 
	cidades.nome AS Cidade,
	COUNT(*) AS Centros
FROM centro_distribuicao
INNER JOIN cidades ON (cidades.codigo = centro_distribuicao.cidade)
GROUP BY cidades.nome;


SELECT
	cidades.nome AS Cidade,
	estados.nome AS Estado
FROM cidades
INNER JOIN estados ON (estados.codigo = cidades.estado);


SELECT
	estados.nome AS Estados,
	COUNT(*) AS Total_Cidades
FROM cidades
INNER JOIN estados ON (estados.codigo = cidades.estado)
GROUP BY estados.nome;


SELECT
	centro_distribuicao.nome AS Nome,
    cidades.nome AS Cidade,
    estados.nome AS Estados
FROM centro_distribuicao
INNER JOIN cidades ON (cidades.codigo = centro_distribuicao.cidade)
INNER JOIN estados ON (estados.codigo = cidades.estado)
WHERE estados.nome IN ('Rio Grande do Sul', 'Santa Catarina', 'Paraná');


DROP TABLE centro_distribuicao;
DROP TABLE cidades;
DROP TABLE estados;
